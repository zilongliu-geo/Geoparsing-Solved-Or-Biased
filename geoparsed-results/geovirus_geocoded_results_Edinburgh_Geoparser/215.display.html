<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <link crossorigin="" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" rel="stylesheet"></link>
  <script crossorigin="" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw==" src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"></script>
  <script type="text/javascript">

    var map;
    var markers = new Array();
    var markers_by_name = {};
    
    var green_icon = new L.Icon({
	iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png',
	shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
	iconSize: [25, 41],
	iconAnchor: [12, 41],
	popupAnchor: [1, -34],
	shadowSize: [41, 41]
    });

    var red_icon = new L.Icon({
	iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png',
	shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
	iconSize: [25, 41],
	iconAnchor: [12, 41],
	popupAnchor: [1, -34],
	shadowSize: [41, 41]
    });

    function load() {

        map = L.map('map');
    
    
	map.setView([-43.53333,172.63333], 8);
      

    L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
	
	  attribution: '© <a href="https://www.mapbox.com/about/maps/">Mapbox</a> © <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> <a href="https://www.mapbox.com/map-feedback/" target="_blank">Improve this map</a>',
	
	    tileSize: 512,
	    maxZoom: 18,
	    zoomOffset: -1,
	    id: 'mapbox/streets-v11',
	    accessToken: 'unset'
	}).addTo(map);
	    
	
    var marker = L.marker([-43.53333,172.63333],
			  {
			      title: "Christchurch",
			      icon: 1 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 1 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(1 == 1)
    markers_by_name["Christchurch"] = marker;
  
    var marker = L.marker([-43.53333,172.66667],
			  {
			      title: "Christchurch",
			      icon: 2 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 2 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(2 == 1)
    markers_by_name["Christchurch"] = marker;
  
    var marker = L.marker([50.73583,-1.78129],
			  {
			      title: "Christchurch",
			      icon: 3 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 3 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(3 == 1)
    markers_by_name["Christchurch"] = marker;
  
    var marker = L.marker([13.08734,-59.52418],
			  {
			      title: "Christ Church",
			      icon: 4 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 4 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(4 == 1)
    markers_by_name["Christchurch"] = marker;
  
    var marker = L.marker([37.60486,-76.5344],
			  {
			      title: "Christchurch",
			      icon: 5 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 5 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(5 == 1)
    markers_by_name["Christchurch"] = marker;
  
    var marker = L.marker([52.54721,0.1999],
			  {
			      title: "Christchurch",
			      icon: 6 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 6 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(6 == 1)
    markers_by_name["Christchurch"] = marker;
  
    var marker = L.marker([51.6,-2.95],
			  {
			      title: "Christchurch",
			      icon: 7 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 7 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(7 == 1)
    markers_by_name["Christchurch"] = marker;
  
    var marker = L.marker([51.81328,-2.62686],
			  {
			      title: "Christchurch",
			      icon: 8 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 8 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(8 == 1)
    markers_by_name["Christchurch"] = marker;
  
    var marker = L.marker([51.45513,0.14097],
			  {
			      title: "Christchurch",
			      icon: 9 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 9 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(9 == 1)
    markers_by_name["Christchurch"] = marker;
  
    var marker = L.marker([52.56056,0.18589],
			  {
			      title: "Christchurch",
			      icon: 10 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 10 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(10 == 1)
    markers_by_name["Christchurch"] = marker;
  
    var marker = L.marker([37.60958,-76.54606],
			  {
			      title: "Christ Church",
			      icon: 11 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 11 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(11 == 1)
    markers_by_name["Christchurch"] = marker;
  
    var marker = L.marker([18.34301,-64.93542],
			  {
			      title: "Christ Church Methodist Church",
			      icon: 12 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 12 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(12 == 1)
    markers_by_name["Christchurch"] = marker;
  
    var marker = L.marker([-42,174],
			  {
			      title: "New Zealand",
			      icon: 1 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 1 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(1 == 1)
    markers_by_name["New Zealand"] = marker;
  
    var marker = L.marker([-42,174],
			  {
			      title: "New Zealand",
			      icon: 2 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 2 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(2 == 1)
    markers_by_name["New Zealand"] = marker;
  
    var marker = L.marker([46.4168,-62.31532],
			  {
			      title: "New Zealand",
			      icon: 3 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 3 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(3 == 1)
    markers_by_name["New Zealand"] = marker;
  
    var marker = L.marker([-43.55,172.73333],
			  {
			      title: "Avon River",
			      icon: 1 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 1 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(1 == 1)
    markers_by_name["Avon River"] = marker;
  
    var marker = L.marker([-41.77828,173.54017],
			  {
			      title: "Avon River",
			      icon: 2 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 2 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(2 == 1)
    markers_by_name["Avon River"] = marker;
  
    var marker = L.marker([-41.68828,173.61017],
			  {
			      title: "Avon River",
			      icon: 3 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 3 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(3 == 1)
    markers_by_name["Avon River"] = marker;
  
    var marker = L.marker([-41.63333,173.66667],
			  {
			      title: "Avon River",
			      icon: 4 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 4 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(4 == 1)
    markers_by_name["Avon River"] = marker;
  
    var marker = L.marker([45.11394,-64.21174],
			  {
			      title: "Avon River",
			      icon: 5 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 5 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(5 == 1)
    markers_by_name["Avon River"] = marker;
  
    var marker = L.marker([38.4479,-77.10692],
			  {
			      title: "Burgess Creek",
			      icon: 6 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 6 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(6 == 1)
    markers_by_name["Avon River"] = marker;
  
    var marker = L.marker([-36.3,142.96667],
			  {
			      title: "Avon River",
			      icon: 7 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 7 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(7 == 1)
    markers_by_name["Avon River"] = marker;
  
    var marker = L.marker([-38.05,147.26667],
			  {
			      title: "Avon River",
			      icon: 8 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 8 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(8 == 1)
    markers_by_name["Avon River"] = marker;
  
    var marker = L.marker([-31.66877,116.14689],
			  {
			      title: "Avon River",
			      icon: 9 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 9 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(9 == 1)
    markers_by_name["Avon River"] = marker;
  
    var marker = L.marker([43.30009,-81.16644],
			  {
			      title: "Avon River",
			      icon: 10 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 10 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(10 == 1)
    markers_by_name["Avon River"] = marker;
  
    var marker = L.marker([-5.94759,147.23189],
			  {
			      title: "Avon River",
			      icon: 11 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 11 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(11 == 1)
    markers_by_name["Avon River"] = marker;
  
    var marker = L.marker([-32.05,151.96667],
			  {
			      title: "Avon River",
			      icon: 12 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 12 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(12 == 1)
    markers_by_name["Avon River"] = marker;
  
    var marker = L.marker([-34.25,150.66667],
			  {
			      title: "Avon River",
			      icon: 13 == 1 ? green_icon : red_icon,
    
			      zIndexOffset: 1000 - 13 * 20
			  });
    marker.addTo(map);
    markers.push(marker);
    if(13 == 1)
    markers_by_name["Avon River"] = marker;
  

	adjust_locations(markers);
    }

    function goto(x, y) {
	map.flyTo([x,y]);
    }

    function goto_name(name) {
        if(markers_by_name.hasOwnProperty(name))
    	    map.flyTo(markers_by_name[name].getLatLng());
    }

    function show_info(name) {
	var para = document.getElementById("message").firstChild;
	para.nodeValue = name;
    }

    
//<![CDATA[

// adjust the locations of identically-positioned candidates so they are
// distinguishable on the map.

function adjust_locations(markers)
{
    markers.sort(compare_locations);

    var dups = new Array();

    var lastlat = 99999, lastlng = 9999;
    for(var i=0; i < markers.length; i++)
    {
        var l = markers[i].getLatLng();
        if(l.lat == lastlat && l.lng == lastlng)
        {
//            alert("match: " + l.lat + "," + l.lng + " = " + lastlat + ","  + lastlng);
            dups.push(markers[i]);
        }
        else
        {
            if(dups.length > 1)
                spread(dups);
            dups.length = 0;
            dups.push(markers[i]);
        }
        lastlat = l.lat;
        lastlng = l.lng;
    }
    if(dups.length > 1)
        spread(dups);
}

// spread an array of identically-positioned markers into a 0.005 degree circle

function spread(dups)
{
    var latlng = dups[0].getLatLng();
    var lat = latlng.lat, lng = latlng.lng;
//    alert("Spreading " + dups.length + " markers from " + lat + "," + lng);
    for(var i=0; i < dups.length; i++)
    {
        var newlatlng = new L.LatLng(
            lat + Math.sin((2 * 3.14159 * i) / dups.length) * 0.005,
            lng + Math.cos((2 * 3.14159 * i) / dups.length) * 0.005);
        dups[i].setLatLng(newlatlng);
//        alert(lat + " -> " + newlatlng.lat + "   " + lng + " -> " + newlatlng.lng);
    }
}

// comparison function for sorting

function compare_locations(m1, m2)
{
    var l1 = m1.getLatLng(), l2 = m2.getLatLng();
    if(l1.lat == l2.lat)
        return l1.lng - l2.lng;
    else
        return l1.lat - l2.lat;
}
//]]>
      </script>
  <style>
	#map   {width: 100%; height: 500px}
        #text  {width: 50%; float: left; background-color: #BBCCAA; margin: 20px;}
        #list  {margin-left: 50%; overflow: scroll;}
        .loc   {background-color: #E0FFE8;}
	table  {border-collapse: collapse; empty-cells: show;}
	tr     {border: 1px solid black;}
	th,td  {padding:  3px;}
	td[best="true"]  {color: green;}
	td[best="false"] {color: red;}
      </style>
 </head>
 <body onload="load()">
  <div onload="load()" id="map"></div>
  <div id="lower">
   <div id="text">
<p>The two inventors of an iodine-based filtration system from <span onClick="goto_name('Christchurch')" class="loc">Christchurch</span>, <span onClick="goto_name('New Zealand')" class="loc">New Zealand</span>, are still backing it even after media tested the 'filtered' water and became violently ill. The inventors are blaming it on a handling error and not the filter itself. The filter is supposed to turn contaminated water into clean, healthy water. Last week Russell Kelly, co-inventor of the filter, invited the media to test it out. Mr Kelly had taken water from both the <span onClick="goto_name('Avon River')" class="loc">Avon River</span> and sewage water and mixed them together and then placed into his filter. The three journalists and the freelance cameraman became ill the next day, experiencing vomiting and diarrhoea. Mr. Kelly is currently overseas but his wife Sue Kelly, co-inventor of the filter, said: "The water the journalists drank could have become contaminated because my husband did not disinfect his hands. We are usually so careful, quite focused, but with the press team there it was not a controlled environment. We feel really disappointed in ourselves but I didn't feel I could interrupt the filming process (to ensure her husband had disinfected his hands)." The three journalists who became sick were from TV One's One News, TV3's 3 News and The New Zealand Herald, the freelance cameraman was working for TV3 at the time. Blair Norton, One News reporter, had drunk the water and became ill, also required medical treatment for a viral infection instead of a bacterial infection, according to Television <span onClick="goto_name('New Zealand')" class="loc">New Zealand</span>, which owns TV One. Beverly Lockhart, 3 News reporter, and cameraman Joe Morgan, both tried a half a glass of the treated water. Ms Lockhart said: "I would not draw any conclusions about the incident but would be wary of any future on-the-job trials. We tried the water about midday on Wednesday and about Thursday at 10pm I was violently ill with vomiting and diarrhoea." The reporter from The New Zealand Herald also became ill after drinking the contaminated water. The Kelly's had invented the filter for aid agencies to make drinkable water in the times of emergencies. They had come up with the idea after they lived in Kashmir, India-Pakistan border, where they saw the problems with water supplies.</p>
</div>
   <div id="list">
    <div id="instr">
     <p>
            Click on a lat/long to centre the map there.
	  </p>
    </div>
    <div id="table">
     <table>
      <tr>
       <th>Christchurch</th>
       <td best="true">
        <a onClick="goto(-43.53333,172.63333)">
         <span style="white-space:nowrap">-43.533,172.633</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(-43.53333,172.66667)">
         <span style="white-space:nowrap">-43.533,172.667</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(50.73583,-1.78129)">
         <span style="white-space:nowrap">50.736,-1.781</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(13.08734,-59.52418)">
         <span style="white-space:nowrap">13.087,-59.524</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(37.60486,-76.5344)">
         <span style="white-space:nowrap">37.605,-76.534</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(52.54721,0.1999)">
         <span style="white-space:nowrap">52.547,0.200</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(51.6,-2.95)">
         <span style="white-space:nowrap">51.600,-2.950</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(51.81328,-2.62686)">
         <span style="white-space:nowrap">51.813,-2.627</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(51.45513,0.14097)">
         <span style="white-space:nowrap">51.455,0.141</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(52.56056,0.18589)">
         <span style="white-space:nowrap">52.561,0.186</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(37.60958,-76.54606)">
         <span style="white-space:nowrap">37.610,-76.546</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(18.34301,-64.93542)">
         <span style="white-space:nowrap">18.343,-64.935</span>
        </a>
       </td>
      </tr>
      <tr>
       <th>New Zealand</th>
       <td best="true">
        <a onClick="goto(-42,174)">
         <span style="white-space:nowrap">-42.000,174.000</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(-42,174)">
         <span style="white-space:nowrap">-42.000,174.000</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(46.4168,-62.31532)">
         <span style="white-space:nowrap">46.417,-62.315</span>
        </a>
       </td>
      </tr>
      <tr>
       <th>Avon River</th>
       <td best="true">
        <a onClick="goto(-43.55,172.73333)">
         <span style="white-space:nowrap">-43.550,172.733</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(-41.77828,173.54017)">
         <span style="white-space:nowrap">-41.778,173.540</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(-41.68828,173.61017)">
         <span style="white-space:nowrap">-41.688,173.610</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(-41.63333,173.66667)">
         <span style="white-space:nowrap">-41.633,173.667</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(45.11394,-64.21174)">
         <span style="white-space:nowrap">45.114,-64.212</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(38.4479,-77.10692)">
         <span style="white-space:nowrap">38.448,-77.107</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(-36.3,142.96667)">
         <span style="white-space:nowrap">-36.300,142.967</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(-38.05,147.26667)">
         <span style="white-space:nowrap">-38.050,147.267</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(-31.66877,116.14689)">
         <span style="white-space:nowrap">-31.669,116.147</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(43.30009,-81.16644)">
         <span style="white-space:nowrap">43.300,-81.166</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(-5.94759,147.23189)">
         <span style="white-space:nowrap">-5.948,147.232</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(-32.05,151.96667)">
         <span style="white-space:nowrap">-32.050,151.967</span>
        </a>
       </td>
       <td best="false">
        <a onClick="goto(-34.25,150.66667)">
         <span style="white-space:nowrap">-34.250,150.667</span>
        </a>
       </td>
      </tr>
     </table>
    </div>
   </div>
  </div>
 </body>
</html>
